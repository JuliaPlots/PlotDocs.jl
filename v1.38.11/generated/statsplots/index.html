<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>StatsPlots · Plots</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../democards/bulmagridtheme.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Plots logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Plots</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../basics/">Basics</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Series Types</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../series_types/contour/">Contour Plots</a></li><li><a class="tocitem" href="../../series_types/histogram/">Histograms</a></li></ul></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../input_data/">Input Data</a></li><li><a class="tocitem" href="../../output/">Output</a></li><li><a class="tocitem" href="../../attributes/">Attributes</a></li><li><a class="tocitem" href="../attributes_series/">Series Attributes</a></li><li><a class="tocitem" href="../attributes_plot/">Plot Attributes</a></li><li><a class="tocitem" href="../attributes_subplot/">Subplot Attributes</a></li><li><a class="tocitem" href="../attributes_axis/">Axis Attributes</a></li><li><a class="tocitem" href="../../layouts/">Layouts</a></li><li><input class="collapse-toggle" id="menuitem-3-9" type="checkbox"/><label class="tocitem" for="menuitem-3-9"><span class="docs-label">Recipes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../recipes/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-3-9-2" type="checkbox"/><label class="tocitem" for="menuitem-3-9-2"><span class="docs-label">RecipesBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../RecipesBase/">Home</a></li><li><a class="tocitem" href="../../RecipesBase/syntax/">Recipes Syntax</a></li><li><a class="tocitem" href="../../RecipesBase/types/">Recipes Types</a></li><li><a class="tocitem" href="../../RecipesBase/internals/">Internals</a></li><li><a class="tocitem" href="../../RecipesBase/api/">Public API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-9-3" type="checkbox"/><label class="tocitem" for="menuitem-3-9-3"><span class="docs-label">RecipesPipeline</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../RecipesPipeline/">Home</a></li><li><a class="tocitem" href="../../RecipesPipeline/api/">Public API</a></li></ul></li></ul></li><li><a class="tocitem" href="../../colors/">Colors</a></li><li><a class="tocitem" href="../colorschemes/">ColorSchemes</a></li><li><a class="tocitem" href="../../animations/">Animations</a></li><li><a class="tocitem" href="../plotthemes/">Themes</a></li><li><a class="tocitem" href="../../backends/">Backends</a></li><li><a class="tocitem" href="../supported/">Supported Attributes</a></li></ul></li><li><a class="tocitem" href="../../learning/">Learning</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><span class="tocitem">Ecosystem</span><ul><li class="is-active"><a class="tocitem" href>StatsPlots</a><ul class="internal"><li><a class="tocitem" href="#Visualizing-a-table-interactively"><span>Visualizing a table interactively</span></a></li><li><a class="tocitem" href="#marginalhist-with-DataFrames"><span>marginalhist with DataFrames</span></a></li><li><a class="tocitem" href="#marginalscatter-with-DataFrames"><span>marginalscatter with DataFrames</span></a></li><li><a class="tocitem" href="#marginalkde"><span>marginalkde</span></a></li><li><a class="tocitem" href="#corrplot-and-cornerplot"><span>corrplot and cornerplot</span></a></li><li><a class="tocitem" href="#boxplot,-dotplot,-and-violin"><span>boxplot, dotplot, and violin</span></a></li><li><a class="tocitem" href="#Equal-area-histograms"><span>Equal-area histograms</span></a></li><li><a class="tocitem" href="#AndrewsPlot"><span>AndrewsPlot</span></a></li><li><a class="tocitem" href="#ErrorLine"><span>ErrorLine</span></a></li><li><a class="tocitem" href="#Distributions"><span>Distributions</span></a></li><li><a class="tocitem" href="#Grouped-Bar-plots"><span>Grouped Bar plots</span></a></li><li><a class="tocitem" href="#Grouped-Histograms"><span>Grouped Histograms</span></a></li><li><a class="tocitem" href="#Dendrograms"><span>Dendrograms</span></a></li><li><a class="tocitem" href="#GroupedErrors.jl-for-population-analysis"><span>GroupedErrors.jl for population analysis</span></a></li><li><a class="tocitem" href="#Ordinations"><span>Ordinations</span></a></li><li><a class="tocitem" href="#Covariance-ellipses"><span>Covariance ellipses</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">GraphRecipes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../GraphRecipes/introduction/">Introduction</a></li><li><a class="tocitem" href="../../GraphRecipes/examples/">Examples</a></li><li><a class="tocitem" href="../graph_attributes/">Attributes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">UnitfulExt</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../UnitfulExt/unitfulext/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-6-3-2" type="checkbox"/><label class="tocitem" for="menuitem-6-3-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../unitfulext_examples/">Simple</a></li><li><a class="tocitem" href="../unitfulext_plots/">Plots</a></li></ul></li></ul></li><li><a class="tocitem" href="../../ecosystem/">Overview</a></li></ul></li><li><span class="tocitem">Advanced Topics</span><ul><li><a class="tocitem" href="../../pipeline/">Internals</a></li></ul></li><li><span class="tocitem">Gallery</span><ul><li><a class="tocitem" href="../../gallery/gr/">GR</a></li><li><a class="tocitem" href="../../gallery/pythonplot/">PythonPlot</a></li><li><a class="tocitem" href="../../gallery/plotlyjs/">PlotlyJS</a></li><li><a class="tocitem" href="../../gallery/pgfplotsx/">PGFPlotsX</a></li><li><a class="tocitem" href="../../gallery/unicodeplots/">UnicodePlots</a></li><li><a class="tocitem" href="../../gallery/gaston/">Gaston</a></li><li><a class="tocitem" href="../../gallery/inspectdr/">InspectDR</a></li></ul></li><li><a class="tocitem" href="../../user_gallery/">User Gallery</a></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Ecosystem</a></li><li class="is-active"><a href>StatsPlots</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>StatsPlots</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaPlots/PlotDocs.jl/blob/master/docs/work/generated/statsplots.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="StatsPlots"><a class="docs-heading-anchor" href="#StatsPlots">StatsPlots</a><a id="StatsPlots-1"></a><a class="docs-heading-anchor-permalink" href="#StatsPlots" title="Permalink"></a></h1><p><a href="https://travis-ci.org/JuliaPlots/StatsPlots.jl"><img src="https://travis-ci.org/JuliaPlots/StatsPlots.jl.svg?branch=master" alt="Build Status"/></a> <a href="https://docs.juliaplots.org/latest/generated/statsplots/"><img src="https://img.shields.io/badge/docs-stable-blue.svg" alt="Documentation"/></a> <a href="https://julialang.zulipchat.com/#narrow/stream/236493-plots"><img src="https://img.shields.io/badge/zulip-join_chat-brightgreen.svg" alt="project chat"/></a></p><h3 id="Original-author:-Thomas-Breloff-(@tbreloff),-maintained-by-the-JuliaPlots-members"><a class="docs-heading-anchor" href="#Original-author:-Thomas-Breloff-(@tbreloff),-maintained-by-the-JuliaPlots-members">Original author: Thomas Breloff (@tbreloff), maintained by the JuliaPlots members</a><a id="Original-author:-Thomas-Breloff-(@tbreloff),-maintained-by-the-JuliaPlots-members-1"></a><a class="docs-heading-anchor-permalink" href="#Original-author:-Thomas-Breloff-(@tbreloff),-maintained-by-the-JuliaPlots-members" title="Permalink"></a></h3><p>This package is a drop-in replacement for Plots.jl that contains many statistical recipes for concepts and types introduced in the JuliaStats organization.</p><ul><li>Types:<ul><li>DataFrames</li><li>Distributions</li></ul></li><li>Recipes:<ul><li>histogram/histogram2d</li><li>groupedhist</li><li><a href="https://en.wikipedia.org/wiki/Box_plot">boxplot</a></li><li><a href="https://en.wikipedia.org/wiki/Dot_plot_(statistics)">dotplot</a></li><li><a href="https://en.wikipedia.org/wiki/Violin_plot">violin</a></li><li>marginalhist</li><li>corrplot/cornerplot</li><li><a href="https://en.wikipedia.org/wiki/Andrews_plot">andrewsplot</a></li><li>errorline (<a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">ribbon</a>, <a href="https://www.mathworks.com/help/matlab/ref/errorbar.html">stick</a>, <a href="https://www.e-education.psu.edu/files/meteo410/file/Plume.pdf">plume</a>)</li><li>MDS plot</li><li><a href="https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot">qq-plot</a></li></ul></li></ul><p>It is thus slightly less lightweight, but has more functionality.</p><p>Initialize:</p><pre><code class="language-julia hljs">#]add StatsPlots # install the package if it isn&#39;t installed
using StatsPlots # no need for `using Plots` as that is reexported here
gr(size=(400,300))</code></pre><p>Table-like data structures, including <code>DataFrames</code>, <code>IndexedTables</code>, <code>DataStreams</code>, etc... (see <a href="https://github.com/davidanthoff/IterableTables.jl">here</a> for an exhaustive list), are supported thanks to the macro <code>@df</code> which allows passing columns as symbols. Those columns can then be manipulated inside the <code>plot</code> call, like normal <code>Arrays</code>:</p><pre><code class="language-julia hljs">using DataFrames, IndexedTables
df = DataFrame(a = 1:10, b = 10 .* rand(10), c = 10 .* rand(10))
@df df plot(:a, [:b :c], colour = [:red :blue])
@df df scatter(:a, :b, markersize = 4 .* log.(:c .+ 0.1))
t = table(1:10, rand(10), names = [:a, :b]) # IndexedTable
@df t scatter(2 .* :b)</code></pre><p>Inside a <code>@df</code> macro call, the <code>cols</code> utility function can be used to refer to a range of columns:</p><pre><code class="language-julia hljs">@df df plot(:a, cols(2:3), colour = [:red :blue])</code></pre><p>or to refer to a column whose symbol is represented by a variable:</p><pre><code class="language-julia hljs">s = :b
@df df plot(:a, cols(s))</code></pre><p><code>cols()</code> will refer to all columns of the data table.</p><p>In case of ambiguity, symbols not referring to <code>DataFrame</code> columns must be escaped by <code>^()</code>:</p><pre><code class="language-julia hljs">df[:red] = rand(10)
@df df plot(:a, [:b :c], colour = ^([:red :blue]))</code></pre><p>The <code>@df</code> macro plays nicely with the new syntax of the <a href="https://github.com/davidanthoff/Query.jl">Query.jl</a> data manipulation package (v0.8 and above), in that a plot command can be added at the end of a query pipeline, without having to explicitly collect the outcome of the query first:</p><pre><code class="language-julia hljs">using Query, StatsPlots
df |&gt;
    @filter(_.a &gt; 5) |&gt;
    @map({_.b, d = _.c-10}) |&gt;
    @df scatter(:b, :d)</code></pre><p>The <code>@df</code> syntax is also compatible with the Plots.jl grouping machinery:</p><pre><code class="language-julia hljs">using RDatasets
school = RDatasets.dataset(&quot;mlmRev&quot;,&quot;Hsb82&quot;)
@df school density(:MAch, group = :Sx)</code></pre><p>To group by more than one column, use a tuple of symbols:</p><pre><code class="language-julia hljs">@df school density(:MAch, group = (:Sx, :Sector), legend = :topleft)</code></pre><p><img src="https://user-images.githubusercontent.com/6333339/35101563-eacf9be4-fc57-11e7-88d3-db5bb47b08ac.png" alt="grouped"/></p><p>To name the legend entries with custom or automatic names (i.e. <code>Sex = Male, Sector = Public</code>) use the curly bracket syntax <code>group = {Sex = :Sx, :Sector}</code>. Entries with <code>=</code> get the custom name you give, whereas entries without <code>=</code> take the name of the column.</p><hr/><p>The old syntax, passing the <code>DataFrame</code> as the first argument to the <code>plot</code> call is no longer supported.</p><hr/><h2 id="Visualizing-a-table-interactively"><a class="docs-heading-anchor" href="#Visualizing-a-table-interactively">Visualizing a table interactively</a><a id="Visualizing-a-table-interactively-1"></a><a class="docs-heading-anchor-permalink" href="#Visualizing-a-table-interactively" title="Permalink"></a></h2><p>A GUI based on the Interact package is available to create plots from a table interactively, using any of the recipes defined below. This small app can be deployed in a Jupyter lab / notebook, Juno plot pane, a Blink window or in the browser, see <a href="http://juliagizmos.github.io/Interact.jl/latest/deploying/">here</a> for instructions.</p><pre><code class="language-julia hljs">import RDatasets
iris = RDatasets.dataset(&quot;datasets&quot;, &quot;iris&quot;)
using StatsPlots, Interact
using Blink
w = Window()
body!(w, dataviewer(iris))</code></pre><p><img src="https://user-images.githubusercontent.com/6333339/43359702-abd82d74-929e-11e8-8fc9-b589287f1c23.png" alt="dataviewer"/></p><h2 id="marginalhist-with-DataFrames"><a class="docs-heading-anchor" href="#marginalhist-with-DataFrames">marginalhist with DataFrames</a><a id="marginalhist-with-DataFrames-1"></a><a class="docs-heading-anchor-permalink" href="#marginalhist-with-DataFrames" title="Permalink"></a></h2><pre><code class="language-julia hljs">using RDatasets
iris = dataset(&quot;datasets&quot;,&quot;iris&quot;)
@df iris marginalhist(:PetalLength, :PetalWidth)</code></pre><p><img src="https://user-images.githubusercontent.com/6333339/29869938-fbe08d02-8d7c-11e7-9409-ca47ee3aaf35.png" alt="marginalhist"/></p><hr/><h2 id="marginalscatter-with-DataFrames"><a class="docs-heading-anchor" href="#marginalscatter-with-DataFrames">marginalscatter with DataFrames</a><a id="marginalscatter-with-DataFrames-1"></a><a class="docs-heading-anchor-permalink" href="#marginalscatter-with-DataFrames" title="Permalink"></a></h2><pre><code class="language-julia hljs">using RDatasets
iris = dataset(&quot;datasets&quot;,&quot;iris&quot;)
@df iris marginalscatter(:PetalLength, :PetalWidth)</code></pre><p><img src="https://user-images.githubusercontent.com/12200202/92408723-3aa78e00-f0f3-11ea-8ddc-9517f0f58207.png" alt="marginalscatter"/></p><hr/><h2 id="marginalkde"><a class="docs-heading-anchor" href="#marginalkde">marginalkde</a><a id="marginalkde-1"></a><a class="docs-heading-anchor-permalink" href="#marginalkde" title="Permalink"></a></h2><pre><code class="language-julia hljs">x = randn(1024)
y = randn(1024)
marginalkde(x, x+y)</code></pre><p><img src="https://user-images.githubusercontent.com/90048/96789354-04804e00-13c3-11eb-82d3-6130e8c9d48a.png" alt="correlated-marg"/></p><ul><li><code>levels=N</code> can be used to set the number of contour levels (default 10); levels are evenly-spaced in the cumulative probability mass.</li><li><code>clip=((-xl, xh), (-yl, yh))</code> (default <code>((-3, 3), (-3, 3))</code>) can be used to adjust the bounds of the plot.  Clip values are expressed as multiples of the <code>[0.16-0.5]</code> and <code>[0.5,0.84]</code> percentiles of the underlying 1D distributions (these would be 1-sigma ranges for a Gaussian).</li></ul><h2 id="corrplot-and-cornerplot"><a class="docs-heading-anchor" href="#corrplot-and-cornerplot">corrplot and cornerplot</a><a id="corrplot-and-cornerplot-1"></a><a class="docs-heading-anchor-permalink" href="#corrplot-and-cornerplot" title="Permalink"></a></h2><p>This plot type shows the correlation among input variables. The marker color in scatter plots reveal the degree of correlation. Pass the desired colorgradient to <code>markercolor</code>. With the default gradient positive correlations are blue, neutral are yellow and negative are red. In the 2d-histograms the color gradient show the frequency of points in that bin (as usual controlled by <code>seriescolor</code>).</p><pre><code class="language-julia hljs">gr(size = (600, 500))</code></pre><p>then</p><pre><code class="language-julia hljs">@df iris corrplot([:SepalLength :SepalWidth :PetalLength :PetalWidth], grid = false)</code></pre><p>or also:</p><pre><code class="language-julia hljs">@df iris corrplot(cols(1:4), grid = false)</code></pre><p><img src="https://user-images.githubusercontent.com/8429802/51600111-8a771880-1f01-11e9-818f-6cbfc5efad74.png" alt="corrplot"/></p><p>A correlation plot may also be produced from a matrix:</p><pre><code class="language-julia hljs">M = randn(1000,4)
M[:,2] .+= 0.8sqrt.(abs.(M[:,1])) .- 0.5M[:,3] .+ 5
M[:,3] .-= 0.7M[:,1].^2 .+ 2
corrplot(M, label = [&quot;x$i&quot; for i=1:4])</code></pre><p><img src="https://user-images.githubusercontent.com/8429802/51600126-91059000-1f01-11e9-9d37-f49bee5ff534.png" alt/></p><pre><code class="language-julia hljs">cornerplot(M)</code></pre><p><img src="https://user-images.githubusercontent.com/8429802/51600133-96fb7100-1f01-11e9-9943-4a10f1ad2907.png" alt/></p><pre><code class="language-julia hljs">cornerplot(M, compact=true)</code></pre><p><img src="https://user-images.githubusercontent.com/8429802/51600140-9bc02500-1f01-11e9-87e3-746ae4daccbb.png" alt/></p><hr/><h2 id="boxplot,-dotplot,-and-violin"><a class="docs-heading-anchor" href="#boxplot,-dotplot,-and-violin">boxplot, dotplot, and violin</a><a id="boxplot,-dotplot,-and-violin-1"></a><a class="docs-heading-anchor-permalink" href="#boxplot,-dotplot,-and-violin" title="Permalink"></a></h2><pre><code class="language-julia hljs">import RDatasets
singers = RDatasets.dataset(&quot;lattice&quot;, &quot;singer&quot;)
@df singers violin(string.(:VoicePart), :Height, linewidth=0)
@df singers boxplot!(string.(:VoicePart), :Height, fillalpha=0.75, linewidth=2)
@df singers dotplot!(string.(:VoicePart), :Height, marker=(:black, stroke(0)))</code></pre><p><img src="https://user-images.githubusercontent.com/16589944/98538614-506c3780-228b-11eb-881c-158c2f781798.png" alt="violin"/></p><p>Asymmetric violin or dot plots can be created using the <code>side</code> keyword (<code>:both</code> - default,<code>:right</code> or <code>:left</code>), e.g.:</p><pre><code class="language-julia hljs">singers_moscow = deepcopy(singers)
singers_moscow[:Height] = singers_moscow[:Height] .+ 5
@df singers violin(string.(:VoicePart), :Height, side=:right, linewidth=0, label=&quot;Scala&quot;)
@df singers_moscow violin!(string.(:VoicePart), :Height, side=:left, linewidth=0, label=&quot;Moscow&quot;)
@df singers dotplot!(string.(:VoicePart), :Height, side=:right, marker=(:black,stroke(0)), label=&quot;&quot;)
@df singers_moscow dotplot!(string.(:VoicePart), :Height, side=:left, marker=(:black,stroke(0)), label=&quot;&quot;)</code></pre><p>Dot plots can spread their dots over the full width of their column <code>mode = :uniform</code>, or restricted to the kernel density (i.e. width of violin plot) with <code>mode = :density</code> (default). Horizontal position is random, so dots are repositioned each time the plot is recreated. <code>mode = :none</code> keeps the dots along the center.</p><p><img src="https://user-images.githubusercontent.com/16589944/98538618-52ce9180-228b-11eb-83d2-6d7b7c89fd52.png" alt="violin2"/></p><hr/><h2 id="Equal-area-histograms"><a class="docs-heading-anchor" href="#Equal-area-histograms">Equal-area histograms</a><a id="Equal-area-histograms-1"></a><a class="docs-heading-anchor-permalink" href="#Equal-area-histograms" title="Permalink"></a></h2><p>The ea-histogram is an alternative histogram implementation, where every &#39;box&#39; in the histogram contains the same number of sample points and all boxes have the same area. Areas with a higher density of points thus get higher boxes. This type of histogram shows spikes well, but may oversmooth in the tails. The y axis is not intuitively interpretable.</p><pre><code class="language-julia hljs">a = [randn(100); randn(100) .+ 3; randn(100) ./ 2 .+ 3]
ea_histogram(a, bins = :scott, fillalpha = 0.4)</code></pre><p><img src="https://user-images.githubusercontent.com/8429802/29754490-8d1b01f6-8b86-11e7-9f86-e1063a88dfd8.png" alt="equal area histogram"/></p><hr/><h2 id="AndrewsPlot"><a class="docs-heading-anchor" href="#AndrewsPlot">AndrewsPlot</a><a id="AndrewsPlot-1"></a><a class="docs-heading-anchor-permalink" href="#AndrewsPlot" title="Permalink"></a></h2><p>AndrewsPlots are a way to visualize structure in high-dimensional data by depicting each row of an array or table as a line that varies with the values in columns. https://en.wikipedia.org/wiki/Andrews_plot</p><pre><code class="language-julia hljs">using RDatasets
iris = dataset(&quot;datasets&quot;, &quot;iris&quot;)
@df iris andrewsplot(:Species, cols(1:4), legend = :topleft)</code></pre><p><img src="https://user-images.githubusercontent.com/1159782/46241166-c392e800-c368-11e8-93de-125c6eb38b52.png" alt="iris_andrews_curve"/></p><hr/><h2 id="ErrorLine"><a class="docs-heading-anchor" href="#ErrorLine">ErrorLine</a><a id="ErrorLine-1"></a><a class="docs-heading-anchor-permalink" href="#ErrorLine" title="Permalink"></a></h2><p>The ErrorLine function shows error distributions for lines plots in a variety of styles.</p><pre><code class="language-julia hljs">x = 1:10
y = fill(NaN, 10, 100, 3)
for i = axes(y,3)
    y[:,:,i] = collect(1:2:20) .+ rand(10,100).*5 .* collect(1:2:20) .+ rand()*100
end

errorline(1:10, y[:,:,1], errorstyle=:ribbon, label=&quot;Ribbon&quot;)
errorline!(1:10, y[:,:,2], errorstyle=:stick, label=&quot;Stick&quot;, secondarycolor=:matched)
errorline!(1:10, y[:,:,3], errorstyle=:plume, label=&quot;Plume&quot;)</code></pre><p><img src="https://user-images.githubusercontent.com/24966610/186655231-2b7b9e37-0beb-4796-ad08-cbb84020ffd8.svg" alt="ErrorLine Styles"/></p><hr/><h2 id="Distributions"><a class="docs-heading-anchor" href="#Distributions">Distributions</a><a id="Distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Distributions" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Distributions
plot(Normal(3,5), fill=(0, .5,:orange))</code></pre><p><img src="https://cloud.githubusercontent.com/assets/933338/16718702/561510f6-46f0-11e6-834a-3cf17a5b77d6.png" alt/></p><pre><code class="language-julia hljs">dist = Gamma(2)
scatter(dist, leg=false)
bar!(dist, func=cdf, alpha=0.3)</code></pre><p><img src="https://cloud.githubusercontent.com/assets/933338/16718720/729b6fea-46f0-11e6-9bff-fdf2541ce305.png" alt/></p><h3 id="Quantile-Quantile-plots"><a class="docs-heading-anchor" href="#Quantile-Quantile-plots">Quantile-Quantile plots</a><a id="Quantile-Quantile-plots-1"></a><a class="docs-heading-anchor-permalink" href="#Quantile-Quantile-plots" title="Permalink"></a></h3><p>The <code>qqplot</code> function compares the quantiles of two distributions, and accepts either a vector of sample values or a <code>Distribution</code>. The <code>qqnorm</code> is a shorthand for comparing a distribution to the normal distribution. If the distributions are similar the points will be on a straight line.</p><pre><code class="language-julia hljs">x = rand(Normal(), 100)
y = rand(Cauchy(), 100)

plot(
 qqplot(x, y, qqline = :fit), # qqplot of two samples, show a fitted regression line
 qqplot(Cauchy, y),           # compare with a Cauchy distribution fitted to y; pass an instance (e.g. Normal(0,1)) to compare with a specific distribution
 qqnorm(x, qqline = :R)       # the :R default line passes through the 1st and 3rd quartiles of the distribution
)</code></pre><p><img src="https://user-images.githubusercontent.com/8429802/30989741-0c4f9dac-a49f-11e7-98ff-028192a8d5b1.png" alt="skaermbillede 2017-09-28 kl 22 46 28"/></p><h2 id="Grouped-Bar-plots"><a class="docs-heading-anchor" href="#Grouped-Bar-plots">Grouped Bar plots</a><a id="Grouped-Bar-plots-1"></a><a class="docs-heading-anchor-permalink" href="#Grouped-Bar-plots" title="Permalink"></a></h2><pre><code class="language-julia hljs">groupedbar(rand(10,3), bar_position = :stack, bar_width=0.7)</code></pre><p><img src="https://cloud.githubusercontent.com/assets/933338/18962081/58a2a5e0-863d-11e6-8638-94f88ecc544d.png" alt="tmp"/></p><p>This is the default:</p><pre><code class="language-julia hljs">groupedbar(rand(10,3), bar_position = :dodge, bar_width=0.7)</code></pre><p><img src="https://cloud.githubusercontent.com/assets/933338/18962092/673f6c78-863d-11e6-9ee9-8ca104e5d2a3.png" alt="tmp"/></p><p>The <code>group</code> syntax is also possible in combination with <code>groupedbar</code>:</p><pre><code class="language-julia hljs">ctg = repeat([&quot;Category 1&quot;, &quot;Category 2&quot;], inner = 5)
nam = repeat(&quot;G&quot; .* string.(1:5), outer = 2)

groupedbar(nam, rand(5, 2), group = ctg, xlabel = &quot;Groups&quot;, ylabel = &quot;Scores&quot;,
        title = &quot;Scores by group and category&quot;, bar_width = 0.67,
        lw = 0, framestyle = :box)</code></pre><p><img src="https://user-images.githubusercontent.com/6645258/32116755-b7018f02-bb2a-11e7-82c7-ca471ecaeecf.png" alt/></p><h2 id="Grouped-Histograms"><a class="docs-heading-anchor" href="#Grouped-Histograms">Grouped Histograms</a><a id="Grouped-Histograms-1"></a><a class="docs-heading-anchor-permalink" href="#Grouped-Histograms" title="Permalink"></a></h2><pre><code class="nohighlight hljs">using RDatasets
iris = dataset(&quot;datasets&quot;, &quot;iris&quot;)
@df iris groupedhist(:SepalLength, group = :Species, bar_position = :dodge)</code></pre><p><img src="https://user-images.githubusercontent.com/6033297/77240750-a11d0c00-6ba6-11ea-9715-81a8a7e20cd6.png" alt="dodge"/></p><pre><code class="nohighlight hljs">@df iris groupedhist(:SepalLength, group = :Species, bar_position = :stack)</code></pre><p><img src="https://user-images.githubusercontent.com/6033297/77240749-9c585800-6ba6-11ea-85ea-e023341cb246.png" alt="stack"/></p><h2 id="Dendrograms"><a class="docs-heading-anchor" href="#Dendrograms">Dendrograms</a><a id="Dendrograms-1"></a><a class="docs-heading-anchor-permalink" href="#Dendrograms" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Clustering
D = rand(10, 10)
D += D&#39;
hc = hclust(D, linkage=:single)
plot(hc)</code></pre><p><img src="https://user-images.githubusercontent.com/381464/43355211-855d5aa2-920d-11e8-82d7-2bf1a7aeccb5.png" alt="dendrogram"/></p><p>The <code>branchorder=:optimal</code> option in <code>hclust()</code> can be used to minimize the distance between neighboring leaves:</p><pre><code class="language-julia hljs">using Clustering
using Distances
using StatsPlots
using Random

n = 40

mat = zeros(Int, n, n)
# create banded matrix
for i in 1:n
    last = minimum([i+Int(floor(n/5)), n])
    for j in i:last
        mat[i,j] = 1
    end
end

# randomize order
mat = mat[:, randperm(n)]
dm = pairwise(Euclidean(), mat, dims=2)

# normal ordering
hcl1 = hclust(dm, linkage=:average)
plot(
    plot(hcl1, xticks=false),
    heatmap(mat[:, hcl1.order], colorbar=false, xticks=(1:n, [&quot;$i&quot; for i in hcl1.order])),
    layout=grid(2,1, heights=[0.2,0.8])
    )</code></pre><p><img src="https://user-images.githubusercontent.com/3502975/59949267-a1824e00-9440-11e9-96dd-4628a8372ae2.png" alt="heatmap dendrogram non-optimal"/></p><p>Compare to:</p><pre><code class="language-julia hljs"># optimal ordering
hcl2 = hclust(dm, linkage=:average, branchorder=:optimal)
plot(
    plot(hcl2, xticks=false),
    heatmap(mat[:, hcl2.order], colorbar=false, xticks=(1:n, [&quot;$i&quot; for i in hcl2.order])),
    layout=grid(2,1, heights=[0.2,0.8])
    )</code></pre><p><img src="https://user-images.githubusercontent.com/3502975/59949464-20778680-9441-11e9-8ed7-9a639b50dfb2.png" alt="heatmap dendrogram optimal"/></p><h3 id="Dendrogram-on-the-right-side"><a class="docs-heading-anchor" href="#Dendrogram-on-the-right-side">Dendrogram on the right side</a><a id="Dendrogram-on-the-right-side-1"></a><a class="docs-heading-anchor-permalink" href="#Dendrogram-on-the-right-side" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Distances
using Clustering
using StatsBase
using StatsPlots

pd=rand(Float64,16,7)

dist_col=pairwise(CorrDist(),pd,dims=2)
hc_col=hclust(dist_col, branchorder=:optimal)
dist_row=pairwise(CorrDist(),pd,dims=1)
hc_row=hclust(dist_row, branchorder=:optimal)

pdz=similar(pd)
for row in hc_row.order
	pdz[row,hc_col.order]=zscore(pd[row,hc_col.order])
end
nrows=length(hc_row.order)
rowlabels=(1:16)[hc_row.order]
ncols=length(hc_col.order)
collabels=(1:7)[hc_col.order]
l = grid(2,2,heights=[0.2,0.8,0.2,0.8],widths=[0.8,0.2,0.8,0.2])
plot(
	layout = l,
	plot(hc_col,xticks=false),
	plot(ticks=nothing,border=:none),
	plot(
		pdz[hc_row.order,hc_col.order],
		st=:heatmap,
		#yticks=(1:nrows,rowlabels),
		yticks=(1:nrows,rowlabels),
		xticks=(1:ncols,collabels),
		xrotation=90,
		colorbar=false
	),
	plot(hc_row,yticks=false,xrotation=90,orientation=:horizontal)
)
</code></pre><p><img src="https://raw.githubusercontent.com/oheil/StatsPlots.jl/oh/screenshots/heatmapWithDendroOnRight.jpg" alt="heatmap with dendrograms on top and on the right"/></p><h2 id="GroupedErrors.jl-for-population-analysis"><a class="docs-heading-anchor" href="#GroupedErrors.jl-for-population-analysis">GroupedErrors.jl for population analysis</a><a id="GroupedErrors.jl-for-population-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#GroupedErrors.jl-for-population-analysis" title="Permalink"></a></h2><p>Population analysis on a table-like data structures can be done using the highly recommended <a href="https://github.com/piever/GroupedErrors.jl">GroupedErrors</a> package.</p><p>This external package, in combination with StatsPlots, greatly simplifies the creation of two types of plots:</p><h3 id=".-Subject-by-subject-plot-(generally-a-scatter-plot)"><a class="docs-heading-anchor" href="#.-Subject-by-subject-plot-(generally-a-scatter-plot)">1. Subject by subject plot (generally a scatter plot)</a><a id=".-Subject-by-subject-plot-(generally-a-scatter-plot)-1"></a><a class="docs-heading-anchor-permalink" href="#.-Subject-by-subject-plot-(generally-a-scatter-plot)" title="Permalink"></a></h3><p>Some simple summary statistics are computed for each experimental subject (mean is default but any scalar valued function would do) and then plotted against some other summary statistics, potentially splitting by some categorical experimental variable.</p><h3 id=".-Population-plot-(generally-a-ribbon-plot-in-continuous-case,-or-bar-plot-in-discrete-case)"><a class="docs-heading-anchor" href="#.-Population-plot-(generally-a-ribbon-plot-in-continuous-case,-or-bar-plot-in-discrete-case)">2. Population plot (generally a ribbon plot in continuous case, or bar plot in discrete case)</a><a id=".-Population-plot-(generally-a-ribbon-plot-in-continuous-case,-or-bar-plot-in-discrete-case)-1"></a><a class="docs-heading-anchor-permalink" href="#.-Population-plot-(generally-a-ribbon-plot-in-continuous-case,-or-bar-plot-in-discrete-case)" title="Permalink"></a></h3><p>Some statistical analysis is computed at the single subject level (for example the density/hazard/cumulative of some variable, or the expected value of a variable given another) and the analysis is summarized across subjects (taking for example mean and s.e.m), potentially splitting by some categorical experimental variable.</p><p>For more information please refer to the <a href="https://github.com/piever/GroupedErrors.jl/blob/master/README.md">README</a>.</p><p>A GUI based on QML and the GR Plots.jl backend to simplify the use of StatsPlots.jl and GroupedErrors.jl even further can be found <a href="https://github.com/piever/PlugAndPlot.jl">here</a> (usable but still in alpha stage).</p><h2 id="Ordinations"><a class="docs-heading-anchor" href="#Ordinations">Ordinations</a><a id="Ordinations-1"></a><a class="docs-heading-anchor-permalink" href="#Ordinations" title="Permalink"></a></h2><p>MDS from <a href="https://github.com/JuliaStats/MultivariateStats.jl"><code>MultivariateStats.jl</code></a> can be plotted as scatter plots.</p><pre><code class="language-julia hljs">using MultivariateStats, RDatasets, StatsPlots

iris = dataset(&quot;datasets&quot;, &quot;iris&quot;)
X = convert(Matrix, iris[:, 1:4])
M = fit(MDS, X&#39;; maxoutdim=2)

plot(M, group=iris.Species)</code></pre><p><img src="https://user-images.githubusercontent.com/3502975/64883550-a6186600-d62d-11e9-8f6b-c5094abf5573.png" alt="MDS plot"/></p><p>PCA will be added once the API in MultivariateStats is changed. See https://github.com/JuliaStats/MultivariateStats.jl/issues/109 and https://github.com/JuliaStats/MultivariateStats.jl/issues/95.</p><h2 id="Covariance-ellipses"><a class="docs-heading-anchor" href="#Covariance-ellipses">Covariance ellipses</a><a id="Covariance-ellipses-1"></a><a class="docs-heading-anchor-permalink" href="#Covariance-ellipses" title="Permalink"></a></h2><p>A 2×2 covariance matrix <code>Σ</code> can be plotted as an ellipse, which is a contour line of a Gaussian density function with variance <code>Σ</code>.</p><pre><code class="nohighlight hljs">covellipse([0,2], [2 1; 1 4], n_std=2, aspect_ratio=1, label=&quot;cov1&quot;)
covellipse!([1,0], [1 -0.5; -0.5 3], showaxes=true, label=&quot;cov2&quot;)</code></pre><p><img src="https://user-images.githubusercontent.com/4170948/84170978-f0c2f380-aa82-11ea-95de-ce2fe14e16ec.png" alt="covariance ellipses"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../contributing/">« Contributing</a><a class="docs-footer-nextpage" href="../../GraphRecipes/introduction/">Introduction »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 2 May 2023 08:25">Tuesday 2 May 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
